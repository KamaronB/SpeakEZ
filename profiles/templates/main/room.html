 <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
</head>
{%if user.is_authenticated%}
<body>
  <h1>Chat room between {{user.username}} && {{friend.first_name}}</h1>
    <textarea id="chat-log" cols="100" rows="20"></textarea><br/>
    <input id="chat-message-input" type="text" size="100"/><br/>
    <input id="chat-message-submit" type="button" value="Send"/>
</body>
<script>

    var roomName = "{{ room.room_name}}"
    // var location= window.location
    var endpoint= window.location.host + '/profile/chat/room/' + roomName + '/'
    var ws_start='ws://'
    if(window.location.protocol=='https:')
    {
      //change to secure sockets
      ws_start='wss://'
    }
    var chatSocket = new WebSocket(ws_start + endpoint)
    chatSocket.onmessage = function(e){
      console.log("message",e)
    }
    chatSocket.onopen= function(e){
      console.log("open",e)
    }
    chatSocket.onerror= function(e){
      console.log("error",e)
    }
    chatSocket.onclose= function(e){
      console.log("close",e)
    }
</script>
{%else%}
<h1>These are not the pages you are looking for</h1>
{%endif%}
</html>
